<?php
	$mulURL = "http://www.masterunitlist.info/";

	$url_arr = array(
//		$mulURL.'Unit/QuickDetails?id=7570',
//		$mulURL.'Unit/QuickDetails?id=2306',
//		$mulURL.'Unit/QuickDetails?id=1981',
//		$mulURL.'Unit/QuickDetails?id=496',
//		$mulURL.'Unit/QuickDetails?id=926',
//		$mulURL.'Unit/QuickDetails?id=2289',
//		$mulURL.'Unit/QuickDetails?id=1206',
//		$mulURL.'Unit/QuickDetails?id=2299',
//		$mulURL.'Unit/QuickDetails?id=2299',
//		$mulURL.'Unit/QuickDetails?id=2296',
//		$mulURL.'Unit/QuickDetails?id=273',
//		$mulURL.'Unit/QuickDetails?id=1293',
//		$mulURL.'Unit/QuickDetails?id=2892',
//		$mulURL.'Unit/QuickDetails?id=2598',
//		$mulURL.'Unit/QuickDetails?id=2888',
//		$mulURL.'Unit/QuickDetails?id=1384',
//		$mulURL.'Unit/QuickDetails?id=8239',
//		$mulURL.'Unit/QuickDetails?id=1985',
//		$mulURL.'Unit/QuickDetails?id=8353',
//		$mulURL.'Unit/QuickDetails?id=6272',
//		$mulURL.'Unit/QuickDetails?id=9261',
//		$mulURL.'Unit/QuickDetails?id=8724',
//		$mulURL.'Unit/QuickDetails?id=9261',
//		$mulURL.'Unit/QuickDetails?id=7518',
//		$mulURL.'Unit/QuickDetails?id=8165',
//		$mulURL.'Unit/QuickDetails?id=6571',
//		$mulURL.'Unit/QuickDetails?id=342',
//		$mulURL.'Unit/QuickDetails?id=9397',
//		$mulURL.'Unit/QuickDetails?id=818',
//		$mulURL.'Unit/QuickDetails?id=3486',
//		$mulURL.'Unit/QuickDetails?id=7529',
//		$mulURL.'Unit/QuickDetails?id=2699',
//		$mulURL.'Unit/QuickDetails?id=7431',
//		$mulURL.'Unit/QuickDetails?id=714',
//		$mulURL.'Unit/QuickDetails?id=7565',
//		$mulURL.'Unit/QuickDetails?id=8357',
//		$mulURL.'Unit/QuickDetails?id=8344',
//		$mulURL.'Unit/QuickDetails?id=1786',
//		$mulURL.'Unit/QuickDetails?id=1333',
//		$mulURL.'Unit/QuickDetails?id=926',
//		$mulURL.'Unit/QuickDetails?id=3654',
//		$mulURL.'Unit/QuickDetails?id=8309',
//		$mulURL.'Unit/QuickDetails?id=6571',
//		$mulURL.'Unit/QuickDetails?id=8440',
//		$mulURL.'Unit/QuickDetails?id=72',
//		$mulURL.'Unit/QuickDetails?id=1985',
//		$mulURL.'Unit/QuickDetails?id=43',
//		$mulURL.'Unit/QuickDetails?id=43',
//		$mulURL.'Unit/QuickDetails?id=189',
//		$mulURL.'Unit/QuickDetails?id=2033',
//		$mulURL.'Unit/QuickDetails?id=1773',
//		$mulURL.'Unit/QuickDetails?id=3574',
//		$mulURL.'Unit/QuickDetails?id=2902',
//		$mulURL.'Unit/QuickDetails?id=2492',
//		$mulURL.'Unit/QuickDetails?id=3010',
//		$mulURL.'Unit/QuickDetails?id=924',
//		$mulURL.'Unit/QuickDetails?id=6840',
//		$mulURL.'Unit/QuickDetails?id=8352',
//		$mulURL.'Unit/QuickDetails?id=714',
//		$mulURL.'Unit/QuickDetails?id=6946',
//		$mulURL.'Unit/QuickDetails?id=920',
//		$mulURL.'Unit/QuickDetails?id=100',
//		$mulURL.'Unit/QuickDetails?id=8965',
//		$mulURL.'Unit/QuickDetails?id=2782',
//		$mulURL.'Unit/QuickDetails?id=3473',
//		$mulURL.'Unit/QuickDetails?id=3644',
//		$mulURL.'Unit/QuickDetails?id=247',
//		$mulURL.'Unit/QuickDetails?id=3563',
//		$mulURL.'Unit/QuickDetails?id=3462',
//		$mulURL.'Unit/QuickDetails?id=3426',
//		$mulURL.'Unit/QuickDetails?id=829',
//		$mulURL.'Unit/QuickDetails?id=1033',
//		$mulURL.'Unit/QuickDetails?id=450',
//		$mulURL.'Unit/QuickDetails?id=275',
//		$mulURL.'Unit/QuickDetails?id=1536',
//		$mulURL.'Unit/QuickDetails?id=3216',
//		$mulURL.'Unit/QuickDetails?id=3673',
//		$mulURL.'Unit/QuickDetails?id=5639',
//		$mulURL.'Unit/QuickDetails?id=3220',
//		$mulURL.'Unit/QuickDetails?id=3300',
//		$mulURL.'Unit/QuickDetails?id=2814',
//		$mulURL.'Unit/QuickDetails?id=2811',
//		$mulURL.'Unit/QuickDetails?id=3452',
//		$mulURL.'Unit/QuickDetails?id=3452',
//		$mulURL.'Unit/QuickDetails?id=2021',
//		$mulURL.'Unit/QuickDetails?id=2021',
//		$mulURL.'Unit/QuickDetails?id=2827',
//		$mulURL.'Unit/QuickDetails?id=2827',
//		$mulURL.'Unit/QuickDetails?id=2827',
//		$mulURL.'Unit/QuickDetails?id=3515',
//		$mulURL.'Unit/QuickDetails?id=3515',
//		$mulURL.'Unit/QuickDetails?id=74',
//		$mulURL.'Unit/QuickDetails?id=140',
//		$mulURL.'Unit/QuickDetails?id=388',
//		$mulURL.'Unit/QuickDetails?id=2332',
//		$mulURL.'Unit/QuickDetails?id=3485',
//		$mulURL.'Unit/QuickDetails?id=2491',
//		$mulURL.'Unit/QuickDetails?id=1901',
//		$mulURL.'Unit/QuickDetails?id=593',
//		$mulURL.'Unit/QuickDetails?id=3238',
//		$mulURL.'Unit/QuickDetails?id=3642',
//		$mulURL.'Unit/QuickDetails?id=1936',
//		$mulURL.'Unit/QuickDetails?id=147',
//		$mulURL.'Unit/QuickDetails?id=2348',
//		$mulURL.'Unit/QuickDetails?id=2348',
//		$mulURL.'Unit/QuickDetails?id=1901',
//		$mulURL.'Unit/QuickDetails?id=593',
//		$mulURL.'Unit/QuickDetails?id=1901',
//		$mulURL.'Unit/QuickDetails?id=1936',
//		$mulURL.'Unit/QuickDetails?id=2348',
//		$mulURL.'Unit/QuickDetails?id=1588',
//		$mulURL.'Unit/QuickDetails?id=1897',
//		$mulURL.'Unit/QuickDetails?id=2270',
//		$mulURL.'Unit/QuickDetails?id=1339',
//		$mulURL.'Unit/QuickDetails?id=1552',
//		$mulURL.'Unit/QuickDetails?id=1558',
//		$mulURL.'Unit/QuickDetails?id=516',
//		$mulURL.'Unit/QuickDetails?id=771',
//		$mulURL.'Unit/QuickDetails?id=1410',
//		$mulURL.'Unit/QuickDetails?id=2610',
//		$mulURL.'Unit/QuickDetails?id=3038',
//		$mulURL.'Unit/QuickDetails?id=3642',
//		$mulURL.'Unit/QuickDetails?id=2270',
//		$mulURL.'Unit/QuickDetails?id=1929',
//		$mulURL.'Unit/QuickDetails?id=369',
//		$mulURL.'Unit/QuickDetails?id=712',
//		$mulURL.'Unit/QuickDetails?id=3347',
//		$mulURL.'Unit/QuickDetails?id=8498',
//		$mulURL.'Unit/QuickDetails?id=1985',
//		$mulURL.'Unit/QuickDetails?id=8497',
//		$mulURL.'Unit/QuickDetails?id=8497',
//		$mulURL.'Unit/QuickDetails?id=1978',
//		$mulURL.'Unit/QuickDetails?id=3177',
//		$mulURL.'Unit/QuickDetails?id=1929',
//		$mulURL.'Unit/QuickDetails?id=3467',
//		$mulURL.'Unit/QuickDetails?id=2749',
//		$mulURL.'Unit/QuickDetails?id=1985',
//		$mulURL.'Unit/QuickDetails?id=2004',
//		$mulURL.'Unit/QuickDetails?id=1047',
//		$mulURL.'Unit/QuickDetails?id=918',
//		$mulURL.'Unit/QuickDetails?id=2598',
//		$mulURL.'Unit/QuickDetails?id=1203',
//		$mulURL.'Unit/QuickDetails?id=1923',
//		$mulURL.'Unit/QuickDetails?id=3473',
//		$mulURL.'Unit/QuickDetails?id=342',
//		$mulURL.'Unit/QuickDetails?id=2598',
//		$mulURL.'Unit/QuickDetails?id=811',
//		$mulURL.'Unit/QuickDetails?id=2097',
//		$mulURL.'Unit/QuickDetails?id=2004',
//		$mulURL.'Unit/QuickDetails?id=1978',
//		$mulURL.'Unit/QuickDetails?id=1892',
//		$mulURL.'Unit/QuickDetails?id=2757',
//		$mulURL.'Unit/QuickDetails?id=1053',
//		$mulURL.'Unit/QuickDetails?id=2483',
//		$mulURL.'Unit/QuickDetails?id=2888',
//		$mulURL.'Unit/QuickDetails?id=2591',
//		$mulURL.'Unit/QuickDetails?id=8489',
//		$mulURL.'Unit/QuickDetails?id=8497',
//		$mulURL.'Unit/QuickDetails?id=8497',
//		$mulURL.'Unit/QuickDetails?id=8498',
//		$mulURL.'Unit/QuickDetails?id=8498',
//		$mulURL.'Unit/QuickDetails?id=1552',
//		$mulURL.'Unit/QuickDetails?id=1793',
//		$mulURL.'Unit/QuickDetails?id=1793',
//		$mulURL.'Unit/QuickDetails?id=894',
//		$mulURL.'Unit/QuickDetails?id=894',
//		$mulURL.'Unit/QuickDetails?id=894',
//		$mulURL.'Unit/QuickDetails?id=1793',
//		$mulURL.'Unit/QuickDetails?id=818',
//		$mulURL.'Unit/QuickDetails?id=818',
//		$mulURL.'Unit/QuickDetails?id=1978',
//		$mulURL.'Unit/QuickDetails?id=2892',
//		$mulURL.'Unit/QuickDetails?id=496',
//		$mulURL.'Unit/QuickDetails?id=1985',
//		$mulURL.'Unit/QuickDetails?id=2097',
//		$mulURL.'Unit/QuickDetails?id=7595',
//		$mulURL.'Unit/QuickDetails?id=3345',
//		$mulURL.'Unit/QuickDetails?id=1048',
//		$mulURL.'Unit/QuickDetails?id=7479',
//		$mulURL.'Unit/QuickDetails?id=8518',
//		$mulURL.'Unit/QuickDetails?id=8518',
//		$mulURL.'Unit/QuickDetails?id=1568',
//		$mulURL.'Unit/QuickDetails?id=7518',
//		$mulURL.'Unit/QuickDetails?id=3340',
//		$mulURL.'Unit/QuickDetails?id=465',
//		$mulURL.'Unit/QuickDetails?id=1556',
//		$mulURL.'Unit/QuickDetails?id=7436',
//		$mulURL.'Unit/QuickDetails?id=594',
//		$mulURL.'Unit/QuickDetails?id=1692',
//		$mulURL.'Unit/QuickDetails?id=2757',
//		$mulURL.'Unit/QuickDetails?id=137',
//		$mulURL.'Unit/QuickDetails?id=3493',
//		$mulURL.'Unit/QuickDetails?id=9354',
//		$mulURL.'Unit/QuickDetails?id=1268',
//		$mulURL.'Unit/QuickDetails?id=813',
//		$mulURL.'Unit/QuickDetails?id=7517',
//		$mulURL.'Unit/QuickDetails?id=2757',
//		$mulURL.'Unit/QuickDetails?id=2892',
//		$mulURL.'Unit/QuickDetails?id=1053',
//		$mulURL.'Unit/QuickDetails?id=3183',
//		$mulURL.'Unit/QuickDetails?id=3183',
//		$mulURL.'Unit/QuickDetails?id=1053',
//		$mulURL.'Unit/QuickDetails?id=1827',
//		$mulURL.'Unit/QuickDetails?id=4306',
//		$mulURL.'Unit/QuickDetails?id=9377',
//		$mulURL.'Unit/QuickDetails?id=7794',
//		$mulURL.'Unit/QuickDetails?id=3247',
//		$mulURL.'Unit/QuickDetails?id=1977',
//		$mulURL.'Unit/QuickDetails?id=1923',
//		$mulURL.'Unit/QuickDetails?id=1046',
//		$mulURL.'Unit/QuickDetails?id=917',
//		$mulURL.'Unit/QuickDetails?id=336',
//		$mulURL.'Unit/QuickDetails?id=6298',
//		$mulURL.'Unit/QuickDetails?id=3332',
//		$mulURL.'Unit/QuickDetails?id=3010',
//		$mulURL.'Unit/QuickDetails?id=2491',
//		$mulURL.'Unit/QuickDetails?id=2033',
//		$mulURL.'Unit/QuickDetails?id=8066',
//		$mulURL.'Unit/QuickDetails?id=8066',
//		$mulURL.'Unit/QuickDetails?id=107',
//		$mulURL.'Unit/QuickDetails?id=2270',
//		$mulURL.'Unit/QuickDetails?id=3347',
//		$mulURL.'Unit/QuickDetails?id=6287',
//		$mulURL.'Unit/QuickDetails?id=8333',
//		$mulURL.'Unit/QuickDetails?id=3497',
//		$mulURL.'Unit/QuickDetails?id=294',
//		$mulURL.'Unit/QuickDetails?id=8192',
//		$mulURL.'Unit/QuickDetails?id=2757',
//		$mulURL.'Unit/QuickDetails?id=3473',
//		$mulURL.'Unit/QuickDetails?id=342',
//		$mulURL.'Unit/QuickDetails?id=222',
//		$mulURL.'Unit/QuickDetails?id=2093',
//		$mulURL.'Unit/QuickDetails?id=148',
//		$mulURL.'Unit/QuickDetails?id=8387',
//		$mulURL.'Unit/QuickDetails?id=2065',
//		$mulURL.'Unit/QuickDetails?id=821',
//		$mulURL.'Unit/QuickDetails?id=2065',
//		$mulURL.'Unit/QuickDetails?id=7594',
//		$mulURL.'Unit/QuickDetails?id=894',
//		$mulURL.'Unit/QuickDetails?id=1209',
//		$mulURL.'Unit/QuickDetails?id=1784',
//		$mulURL.'Unit/QuickDetails?id=7442',
//		$mulURL.'Unit/QuickDetails?id=272',
//		$mulURL.'Unit/QuickDetails?id=8518',
//		$mulURL.'Unit/QuickDetails?id=3332',
//		$mulURL.'Unit/QuickDetails?id=7751',
//		$mulURL.'Unit/QuickDetails?id=9259',
//		$mulURL.'Unit/QuickDetails?id=7569',
//		$mulURL.'Unit/QuickDetails?id=9259',
//		$mulURL.'Unit/QuickDetails?id=9259',
//		$mulURL.'Unit/QuickDetails?id=7673',
//		$mulURL.'Unit/QuickDetails?id=8517',
//		$mulURL.'Unit/QuickDetails?id=6946',
//		$mulURL.'Unit/QuickDetails?id=341',
//		$mulURL.'Unit/QuickDetails?id=3122',
//		$mulURL.'Unit/QuickDetails?id=1979',
//		$mulURL.'Unit/QuickDetails?id=7525',
//		$mulURL.'Unit/QuickDetails?id=8454',
//		$mulURL.'Unit/QuickDetails?id=1209',
//		$mulURL.'Unit/QuickDetails?id=1475',
//		$mulURL.'Unit/QuickDetails?id=3747',
//		$mulURL.'Unit/QuickDetails?id=8179',
//		$mulURL.'Unit/QuickDetails?id=1953',
//		$mulURL.'Unit/QuickDetails?id=2807',
//		$mulURL.'Unit/QuickDetails?id=1440',
//		$mulURL.'Unit/QuickDetails?id=6556'
	);


			//{
			//   "Id":925,
			//   "Name":"Dragonfly (Viper) I",
			//   "GroupName":null,
			//   "Class":"Dragonfly (Viper)",
			//   "Variant":"I",
			//   "Tonnage":40,
			//   "BattleValue":1580,
			//   "Technology":{
			//      "Id":2,
			//      "Name":"Clan",
			//      "Image":null,
			//      "SortOrder":0
			//   },
			//   "Cost":11432283,
			//   "Rules":"Standard",
			//   "TROId":436,
			//   "TRO":"TR:CI",
			//   "RSId":437,
			//   "RS":"RS:CI",
			//   "EraIcon":"https://i.ibb.co/4jf2wfz/era05-jihad.png",
			//   "DateIntroduced":"3068",
			//   "EraId":14,
			//   "EraStart":3068,
			//   "ImageUrl":"https://i.ibb.co/TKRRrbQ/dragonfly-viper-rg.png",
			//   "IsFeatured":false,
			//   "IsPublished":true,
			//   "Release":1.00,
			//   "Type":{
			//      "Id":18,
			//      "Name":"BattleMech",
			//      "Image":"BattleMech.gif",
			//      "SortOrder":0
			//   },
			//   "Role":{
			//      "Id":106,
			//      "Name":"Striker",
			//      "Image":null,
			//      "SortOrder":8
			//   },
			//   "BFType":"BM",
			//   "BFSize":2,
			//   "BFMove":"16\"j",
			//   "BFTMM":3,
			//   "BFArmor":4,
			//   "BFStructure":2,
			//   "BFThreshold":0,
			//   "BFDamageShort":3,
			//   "BFDamageShortMin":false,
			//   "BFDamageMedium":3,
			//   "BFDamageMediumMin":false,
			//   "BFDamageLong":0,
			//   "BFDamageLongMin":true,
			//   "BFDamageExtreme":0,
			//   "BFDamageExtemeMin":false,
			//   "BFOverheat":1,
			//   "BFPointValue":42,
			//   "BFAbilities":"AMS,CASE,LPRB,OMNI,RCN",
			//   "Skill":4,
			//   "FormatedTonnage":"40"
			//}

	$opts = array('http'=>array('header' => "User-Agent:MyAgent/1.0\r\n"));
	$context = stream_context_create($opts);

	require('../../config.php');
	$conn = mysqli_connect($db_host, $db_user, $db_pass, $db_name);
	if ($conn->connect_error) {
		die("Connection failed: " . $conn->connect_error);
	}

	foreach ($url_arr as $key => &$url_value) {
		$content = file_get_contents($url_value, false, $context);

		//echo $content;

		if ($content === FALSE) {
			echo "Error while saving " . $filename_arr[$key];
		} else {
			$unit = json_decode($content);
			if (!empty($unit->Id) && $unit->Id > 0 && $unit->Id != "") {

				$cleanName1 = str_replace('“', '"', $unit->Name);
				$cleanName = str_replace('”', '"', $cleanName1);

				//echo $unit->Id.";";
				//echo $cleanName.";";
				//echo $unit->BattleValue.";";
				//echo $unit->BFPointValue.";<br>";

				$sql_update_unit = "update asc_unit set pointvalue=".$unit->BFPointValue.", battlevalue=".$unit->BattleValue." where mulid=".$unit->Id;

				echo $sql_update_unit."<br>";
				echo "NOT doing any updates, look up script!";
				//$result_update_unit = mysqli_query($conn, $sql_update_unit);

				echo $result_update_unit."<br><br>";

			} else {
				// Failed, no unitId
				echo "Failed";
			}
			flush();
		}
	}
?>
